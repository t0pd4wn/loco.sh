#!/bin/bash
#-------------------------------------------------------------------------------
# loco | loco user interface
#-------------------------------------------------------------------------------

set -eu

# source functions file
if ! source ./src/functions.sh; then
  echo "Unable to source ./src/functions.sh" >&2
  exit 1
fi

# detect and check if OS is supported
utils::check_operating_system

# set globals
utils::GLOBALS_set

# set options, build and source the cli file
cli::set_options
cli::build
cli::call "${@-}"

# load default or user conf
utils::source "${CONFIG_PATH}"

# lock globals
utils::GLOBALS_lock

echo "debug?"

# init debug message
msg::debug "Verbose mode"

# check if first start, else display start messsage
utils::check_if_start

# check if first root, otherwise ask password and restart
utils::check_if_root "${@-}"

# call the main function
main "${@-}"